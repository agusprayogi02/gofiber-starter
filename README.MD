# Starter Template Go Fiber

Backend Golang With Fiber Framework

## Getting Started

### Prerequisites

Sebelum menjalankan project ini, pastikan sistem Anda telah memiliki:

#### Required or higher** - [Download Go](https://golang.org/dl/)
- **PostgreSQL 14+** atau **MySQL 8+** atau **SQL Server 2019+** - Database utama
- **Redis 6+** - Untuk caching dan background job queue (Asynq)
- **OpenSSL** - Untuk generate RSA key pair (JWT signing)

#### Optional (Recommended)
- **Docker & Docker Compose** - Untuk menjalankan dependencies (Redis, Database, Mailpit)
- **Make** - Untuk automation tasks (jika menggunakan Makefile)
- **Git** - Version control
- **Mailpit** - Local SMTP server untuk testing email (development)
  ```bash
  docker run -d -p 1025:1025 -p 8025:8025 mailpit/mailpit
  ```

#### Development Tools
- **Air** - Live reload untuk development
- **golangci-lint** - Code linting (optional)
- **Postman** atau **Insomnia** - API testing

### Installation

#### 1. Clone Repository
```bash
git clone <repository-url>
cd starter-gofiber
```

#### 2. Install Dependencies
```bash
go mod download
go mod verify
```

#### 3. Install Development Tools
```bash
# Install Air for live reload
go install github.com/air-verse/air@latest

# (Optional) Install golangci-lint for code linting
go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest
```

#### 4. Setup Environment Variables
```bash
# Copy example environment file
cp .env.example .env

# Edit .env file dengan text editor favorit
nano .env  # atau vim, code, dll
```

**Konfigurasi minimal yang harus diisi:**
```env
# Application
ENV_TYPE=dev
APP_URL=http://localhost:3000

# Database (pilih salah satu)
# PostgreSQL
DB_DRIVER=postgres
DB_HOST=localhost
DB_PORT=5432
DB_NAME=starter_gofiber
DB_USER=postgres
DB_PASSWORD=your_password

# Redis (required untuk caching dan background jobs)
REDIS_HOST=localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# SMTP (untuk email - gunakan Mailpit untuk development)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_FROM=noreply@localhost
SMTP_FROM_NAME=Starter GoFiber
SMTP_USE_TLS=false

# Sentry (optional - untuk error tracking)
SENTRY_DSN=
```

#### 5. Generate RSA Key Pair untuk JWT
```bash
# Buat directory untuk certificates
mkdir -p assets/certs

# Generate private key (4096 bit RSA)
openssl genpkey -algorithm RSA -out assets/certs/certificate.pem -pkeyopt rsa_keygen_bits:4096

# Set permission (recommended)
chmod 600 assets/certs/certificate.pem
```

**Update .env:**
```env
LOCATION_CERT=assets/certs/certificate.pem
```

#### 6. Setup Database

**Opsi A: Menggunakan Docker Compose**
```bash
# Start PostgreSQL + Redis + Mailpit
docker-compose up -d

# Check status
docker-compose ps
```

**Opsi B: Manual Setup**
```bash
# Buat database (PostgreSQL example)
createdb starter_gofiber

# Atau menggunakan psql
psql -U postgres -c "CREATE DATABASE starter_gofiber;"
```

#### 7. Run Database Migrations
```bash
# Buat table dan structure database
go run ./cmd/api/main.go migrate up

# Atau menggunakan custom migration command jika ada
# go run scripts/migrate.go up
```

#### 8. (Optional) Seed Database
```bash
# Seeders akan dijalankan secara otomatis jika dikonfigurasi
# Atau bisa menggunakan pkg/database seeder secara manual
```

#### 9. Run Application

**Development Mode (dengan Air - Live Reload):**
```bash
# Air akan otomatis build dan run dari cmd/api/main.go
air
```

**Standard Mode:**
```bash
# Run langsung tanpa build
go run ./cmd/api/main.go
```

**Build dan Run Binary:**
```bash
# Build binary
go build -o bin/app ./cmd/api

# Run binary
./bin/app
```

#### 10. Verify Installation

Application akan berjalan di `http://localhost:3000` (atau port yang dikonfigurasi di `.env`)

**Health Check:**
```bash
curl http://localhost:3000/health
```

**Expected Response:**
```json
{
  "status": "ok",
  "timestamp": "2026-01-01T12:00:00Z",
  "version": "1.0.0"
}
```

**Access Points:**
- API: `http://localhost:3000/api`
- Health: `http://localhost:3000/health`
- Metrics: `http://localhost:3000/metrics`
- Mailpit UI (email testing): `http://localhost:8025`

### Database Configuration Notes

#### PostgreSQL
Default dan recommended. Tidak perlu konfigurasi khusus.

#### MySQL
Pastikan menggunakan charset `utf8mb4`:
```env
DB_DRIVER=mysql
DB_CHARSET=utf8mb4
```

#### SQL Server
Untuk SQL Server, perlu adjust enum data type di model:
```go
// internal/domain/user/entity.go
type User struct {
    ID       uint     `gorm:"primaryKey;autoIncrement"`
    Name     string   `gorm:"type:varchar(200);not null"`
    Email    string   `gorm:"type:varchar(200);uniqueIndex;not null"`
    Password string   `gorm:"type:varchar(150);not null"`
    Role     UserRole `gorm:"type:varchar(10);default:user"` // Gunakan varchar untuk SQL Server
    gorm.Model
}
```

### Docker Deployment

```bash
# Build image
docker build -f assets/docker/Dockerfile -t starter-gofiber .

# Run with docker-compose
docker-compose -f assets/docker/docker-compose.yml up -d

# Check logs
docker-compose -f assets/docker/docker-compose.yml logs -f app
```

### Troubleshooting

#### Port Already in Use
```bash
# Find process using port 3000
lsof -ti:3000

# Kill process
kill -9 $(lsof -ti:3000)
```

#### Redis Connection Failed
```bash
# Check Redis is running
redis-cli ping
# Expected: PONG

# Start Redis (if not running)
redis-server
# Or with Docker:
docker run -d -p 6379:6379 redis:7-alpine
```

#### Database Connection Failed
- Check database credentials di `.env`
- Verify database server is running
- Check firewall rules
- Ensure database exists: `CREATE DATABASE starter_gofiber;`

## Project Structure

Project ini menggunakan **Go Standard Layout** dengan **Domain-Driven Design** dan **Clean Architecture**:

```
starter-gofiber/
‚îú‚îÄ‚îÄ assets/                      # Static assets dan files
‚îÇ   ‚îú‚îÄ‚îÄ certs/                   # SSL certificates dan private keys (JWT)
‚îÇ   ‚îú‚îÄ‚îÄ docker/                  # Docker configurations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile           # Default Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile.optimized # Optimized multi-stage Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml   # Default docker-compose
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.minio.yml  # MinIO S3 storage setup
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dev/                 # Development docker setup
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prod/                # Production docker setup
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ rbac/                    # Casbin RBAC policy files
‚îÇ       ‚îú‚îÄ‚îÄ model.conf           # RBAC model definition
‚îÇ       ‚îî‚îÄ‚îÄ policy.csv           # Role-permission mappings
‚îÇ
‚îú‚îÄ‚îÄ backups/                     # Database backups (auto-generated)
‚îÇ
‚îú‚îÄ‚îÄ cmd/                         # Application entry points
‚îÇ   ‚îú‚îÄ‚îÄ api/                     # Main API server
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.go              # API server entry point
‚îÇ   ‚îî‚îÄ‚îÄ worker/                  # Background worker server
‚îÇ       ‚îî‚îÄ‚îÄ main.go              # Worker server entry point
‚îÇ
‚îú‚îÄ‚îÄ migrations/                  # Database migration files
‚îÇ   ‚îú‚îÄ‚îÄ README.md                # Migration documentation
‚îÇ   ‚îú‚îÄ‚îÄ 000003_add_user_profile_fields.up.sql
‚îÇ   ‚îî‚îÄ‚îÄ 000003_add_user_profile_fields.down.sql
‚îÇ
‚îú‚îÄ‚îÄ migrations/                  # Database migration files
‚îÇ   ‚îú‚îÄ‚îÄ 000003_add_user_profile_fields.up.sql
‚îÇ   ‚îî‚îÄ‚îÄ 000003_add_user_profile_fields.down.sql
‚îÇ
‚îú‚îÄ‚îÄ cmd/                         # Application entry points
‚îÇ   ‚îú‚îÄ‚îÄ api/                     # Main API server
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.go              # API server entry point
‚îÇ   ‚îî‚îÄ‚îÄ worker/                  # Background worker server
‚îÇ       ‚îî‚îÄ‚îÄ main.go              # Worker server entry point (optional)
‚îÇ
‚îú‚îÄ‚îÄ docs/                        # Documentation files
‚îÇ   ‚îú‚îÄ‚îÄ API_AUTH.md              # Authentication API docs
‚îÇ   ‚îú‚îÄ‚îÄ API_FEATURES.md          # Advanced API features
‚îÇ   ‚îú‚îÄ‚îÄ API_FEATURES_QUICK_REF.md # API features quick reference
‚îÇ   ‚îú‚îÄ‚îÄ ARCHITECTURE.md          # Architecture overview
‚îÇ   ‚îú‚îÄ‚îÄ BACKGROUND_JOBS.md       # Background jobs & Asynq
‚îÇ   ‚îú‚îÄ‚îÄ BACKGROUND_JOBS_QUICK_REF.md # Background jobs quick reference
‚îÇ   ‚îú‚îÄ‚îÄ CACHING.md               # Redis caching guide
‚îÇ   ‚îú‚îÄ‚îÄ CLOUD_STORAGE_EXAMPLES.md # Cloud storage examples
‚îÇ   ‚îú‚îÄ‚îÄ DATABASE.md              # Database management & Atlas migrations
‚îÇ   ‚îú‚îÄ‚îÄ DEPLOYMENT.md            # Deployment guide
‚îÇ   ‚îú‚îÄ‚îÄ DEVOPS.md                # DevOps & CI/CD guide
‚îÇ   ‚îú‚îÄ‚îÄ EMAIL.md                 # Email system docs
‚îÇ   ‚îú‚îÄ‚îÄ FILE_MANAGEMENT.md       # File upload & storage
‚îÇ   ‚îú‚îÄ‚îÄ LOGGING_MONITORING.md    # Logging & monitoring
‚îÇ   ‚îú‚îÄ‚îÄ MAKEFILE_COMMANDS.md     # Makefile commands reference
‚îÇ   ‚îú‚îÄ‚îÄ METRICS_MONITORING.md    # Metrics & health checks
‚îÇ   ‚îú‚îÄ‚îÄ MIGRATION_GUIDE.md       # Atlas migration quick start
‚îÇ   ‚îú‚îÄ‚îÄ MINIO_SETUP.md           # MinIO S3 storage setup guide
‚îÇ   ‚îú‚îÄ‚îÄ PERFORMANCE.md           # Performance optimization guide
‚îÇ   ‚îú‚îÄ‚îÄ SECURITY.md              # Security features
‚îÇ   ‚îú‚îÄ‚îÄ SECURITY_IMPLEMENTATION.md # Security implementation details
‚îÇ   ‚îú‚îÄ‚îÄ SSE.md                   # Server-Sent Events
‚îÇ   ‚îú‚îÄ‚îÄ TESTING.md               # Testing guide
‚îÇ   ‚îî‚îÄ‚îÄ TEST_COVERAGE.md         # Test coverage reports
‚îÇ
‚îú‚îÄ‚îÄ internal/                    # Private application code (tidak bisa diimport dari luar)
‚îÇ   ‚îú‚îÄ‚îÄ config/                  # Application configurations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.go               # App config (middleware setup)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ asynq.go             # Asynq background jobs config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cloud_storage.go     # S3/MinIO storage config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.go            # Main config loader
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.go          # Database connection config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gorm_logger.go       # GORM logger with Zap
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ permission.go        # Casbin permission init
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ permissions.go       # Permission definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ read_replica.go      # Read replica config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ redis.go             # Redis connection config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage.go            # Storage config
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ timezone.go          # Timezone configuration
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ domain/                  # Domain layer (business entities & interfaces)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post/                # Post domain
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto.go           # Post DTOs (requests/responses)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entity.go        # Post entity (GORM model)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository.go    # Post repository interface
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service.go       # Post service interface
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user/                # User domain
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ apikey.go        # API Key entity
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ dto.go           # User DTOs (requests/responses)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ email_verification.go  # Email verification entity
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ entity.go        # User entity (GORM model)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ password_reset.go      # Password reset entity
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ preferences.go   # User preferences entity
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ refresh_token.go       # Refresh token entity
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ repository.go    # User repository interface
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ service.go       # User service interface
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ token_dto.go     # JWT token DTOs
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ handler/                 # HTTP handlers (presentation layer)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http/                # HTTP handlers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.go          # Authentication & profile endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health.go        # Health check endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jobs.go          # Job management endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.go       # Metrics endpoint
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post.go          # Post CRUD endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sse.go           # Server-Sent Events handler
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middleware/          # HTTP middlewares
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ apikey.go        # API Key authentication
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.go          # JWT authentication
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ authz.go         # Casbin authorization
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ cache.go         # Response caching
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ compression.go   # Response compression
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ csrf.go          # CSRF protection
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ https.go         # HTTPS redirect
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ip_filter.go     # IP filtering
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ logger.go         # Request logging
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ prometheus.go    # Prometheus metrics
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ rate_limiter.go   # Rate limiting
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ security.go      # Security headers
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ sentry.go        # Sentry error tracking
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/          # Infrastructure layer (external services)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                # Authentication infrastructure
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apikey.go        # API Key management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cache/               # Caching infrastructure
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ redis.go         # Redis client wrapper
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ strategy.go      # Cache strategy patterns
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ email/               # Email infrastructure
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.go        # Email configuration
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sender.go       # Email sender implementation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage/             # Storage infrastructure
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ handler.go       # File upload handler
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ image.go         # Image processing
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ s3.go            # S3 client wrapper
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ upload.go        # File upload utilities
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ validation.go    # File validation
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ versioning.go     # File versioning
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ repository/               # Data access layer
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ postgres/            # PostgreSQL implementation
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ email_verification.go
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ password_reset.go
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ post.go          # Post repository implementation
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ refresh_token.go
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ user.go          # User repository implementation (includes preferences)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ service/                 # Business logic layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                # Authentication service
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service.go       # Auth service implementation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ post/                # Post service
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ service.go       # Post service implementation
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ worker/                  # Background worker (Asynq)
‚îÇ       ‚îú‚îÄ‚îÄ client.go            # Asynq client wrapper
‚îÇ       ‚îú‚îÄ‚îÄ email.go             # Email job handlers
‚îÇ       ‚îú‚îÄ‚îÄ handlers.go          # Job handler implementations
‚îÇ       ‚îú‚îÄ‚îÄ jobs.go              # Job definitions & enqueue functions
‚îÇ       ‚îî‚îÄ‚îÄ scheduler.go         # Periodic task scheduler
‚îÇ
‚îú‚îÄ‚îÄ pkg/                         # Public library code (bisa diimport dari luar)
‚îÇ   ‚îú‚îÄ‚îÄ apierror/                # API error types
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ error.go            # Custom error definitions
‚îÇ   ‚îú‚îÄ‚îÄ crypto/                  # Cryptographic utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ encryption.go       # AES encryption
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hash.go             # Hashing utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt.go              # JWT token utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ password.go         # Password hashing (bcrypt)
‚îÇ   ‚îú‚îÄ‚îÄ database/                # Database utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ audit.go            # Audit logging
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bulk.go             # Bulk operations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ indexing.go         # Database indexing utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migration.go        # Migration utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pagination.go       # Pagination helpers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seeder.go           # Database seeder
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ soft_delete.go      # Soft delete utilities
‚îÇ   ‚îú‚îÄ‚îÄ dto/                     # Shared Data Transfer Objects
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ paginate.go         # Pagination DTO
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ response.go         # Standard API responses
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ token.go            # Token DTOs
‚îÇ   ‚îú‚îÄ‚îÄ logger/                  # Logging utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.go           # Zap logger wrapper
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sentry.go           # Sentry integration
‚îÇ   ‚îú‚îÄ‚îÄ pagination/              # Pagination utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cursor.go           # Cursor-based pagination
‚îÇ   ‚îú‚îÄ‚îÄ response/                # Response utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ response.go         # Response formatters
‚îÇ   ‚îú‚îÄ‚îÄ utils/                   # General utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ date.go             # Date/time utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ export.go           # Data export utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filter.go           # Filtering utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.go          # Metrics utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sort.go             # Sorting utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sse.go              # SSE utilities
‚îÇ   ‚îî‚îÄ‚îÄ validator/               # Validation utilities
‚îÇ       ‚îú‚îÄ‚îÄ sanitize.go         # Input sanitization
‚îÇ       ‚îî‚îÄ‚îÄ validator.go        # Input validation
‚îÇ
‚îú‚îÄ‚îÄ router/                      # Route definitions
‚îÇ   ‚îú‚îÄ‚îÄ auth.go                  # Auth routes
‚îÇ   ‚îú‚îÄ‚îÄ post.go                  # Post routes
‚îÇ   ‚îú‚îÄ‚îÄ router.go                # Main router setup
‚îÇ   ‚îî‚îÄ‚îÄ sse.go                   # SSE routes
‚îÇ
‚îú‚îÄ‚îÄ templates/                   # HTML templates
‚îÇ   ‚îî‚îÄ‚îÄ email/                   # Email templates
‚îÇ       ‚îú‚îÄ‚îÄ welcome.html         # Welcome email HTML
‚îÇ       ‚îú‚îÄ‚îÄ welcome.txt          # Welcome email text
‚îÇ       ‚îú‚îÄ‚îÄ reset-password.html  # Password reset HTML
‚îÇ       ‚îú‚îÄ‚îÄ reset-password.txt   # Password reset text
‚îÇ       ‚îú‚îÄ‚îÄ verify-email.html    # Email verification HTML
‚îÇ       ‚îî‚îÄ‚îÄ verify-email.txt     # Email verification text
‚îÇ
‚îú‚îÄ‚îÄ tests/                       # Test files
‚îÇ   ‚îú‚îÄ‚îÄ auth_test.go             # Auth endpoint tests
‚îÇ   ‚îú‚îÄ‚îÄ email_test.go            # Email system tests
‚îÇ   ‚îú‚îÄ‚îÄ post_test.go             # Post endpoint tests
‚îÇ   ‚îî‚îÄ‚îÄ setup_test.go            # Test setup & helpers
‚îÇ
‚îú‚îÄ‚îÄ variables/                   # Global constants & variables
‚îÇ   ‚îî‚îÄ‚îÄ constant.go              # App constants (includes AVATAR_PATH)
‚îÇ
‚îú‚îÄ‚îÄ .air.toml                    # Air live reload config
‚îú‚îÄ‚îÄ .cursorrules                 # AI assistant rules & best practices guide
‚îú‚îÄ‚îÄ .env.example                 # Environment variables template
‚îú‚îÄ‚îÄ .gitignore                   # Git ignore rules
‚îú‚îÄ‚îÄ .golangci.yml                # golangci-lint configuration
‚îú‚îÄ‚îÄ .pre-commit-config.yaml      # Pre-commit hooks configuration
‚îú‚îÄ‚îÄ CONTRIBUTING.md              # Contributing guidelines
‚îú‚îÄ‚îÄ go.mod                       # Go module dependencies
‚îú‚îÄ‚îÄ go.sum                       # Dependency checksums
‚îú‚îÄ‚îÄ LICENSE                      # MIT License
‚îú‚îÄ‚îÄ Makefile                     # Automation tasks (build, test, migrate, etc.)
‚îú‚îÄ‚îÄ README.MD                    # This file
‚îî‚îÄ‚îÄ .github/                     # GitHub configuration
    ‚îî‚îÄ‚îÄ workflows/               # GitHub Actions workflows
        ‚îî‚îÄ‚îÄ ci.yml               # CI/CD pipeline
```

**Note:** Semua code baru harus menggunakan struktur di `internal/` dan `pkg/`. Shared DTOs berada di `pkg/dto/` dan dapat digunakan oleh semua domain.

### Architecture Layers

Project ini menggunakan **Clean Architecture** dengan **Domain-Driven Design**:

1. **Domain Layer** (`internal/domain/`) - Business entities, DTOs, dan interfaces
   - Setiap domain memiliki: `entity.go`, `dto.go`, `repository.go`, `service.go`
   - Domain tidak bergantung pada layer lain (pure business logic)

2. **Repository Layer** (`internal/repository/`) - Data access implementations
   - Implementasi dari interface yang didefinisikan di domain
   - Menggunakan GORM untuk database operations

3. **Service Layer** (`internal/service/`) - Business logic implementations
   - Implementasi dari interface yang didefinisikan di domain
   - Menggunakan repository untuk data access

4. **Handler Layer** (`internal/handler/`) - HTTP request handlers
   - HTTP handlers (`internal/handler/http/`)
   - Middleware (`internal/handler/middleware/`)
   - Menggunakan service untuk business logic

5. **Infrastructure Layer** (`internal/infrastructure/`) - External services
   - Email, Cache, Storage, Auth infrastructure
   - Implementasi untuk external dependencies

6. **Worker Layer** (`internal/worker/`) - Background jobs
   - Asynq job handlers dan schedulers
   - Background task processing

**Data Flow:**
```
Client Request ‚Üí Router ‚Üí Middleware ‚Üí Handler ‚Üí Service ‚Üí Repository ‚Üí Database
                                                    ‚Üì
                                    Infrastructure (Email, Cache, Storage)
                                                    ‚Üì
                                            Worker (Background Jobs)
```

## Warning

- Untuk `Order` pada helper digunakan untuk menandai urutan dari error yang muncul.
	- Keterangan kode huruf pertama: 
		- S: Service
		- H: Handler
		- R: Repository
		- U: Util
	- Contoh:
		- S1: Ada pada service dengan error handling pertama

## Aturan
- jika ada error pada `service`, `util`, `helper` wajib mengembalikan error menggunakan `helper` error handling contoh: 
```go
return nil, &helper.BadRequestError{
	Message: err.Error(),
	Order:   "S1",
}
```
- Agar pada `handler` tinggal return error, contoh:
```go
if err != nil {
	return err
}
```

## Rilis Production dengan docker
- pada file `.env` ganti `ENV_TYPE="prod"`
- ganti file `docker-composer.yml` dan `Dockerfile` dengan yang ada didalam folder `assets/docker/prod`, jangan lupa menyesuaikan configurasi yang akan digunakan 


## Authz
- Authz dibuat dengan `casbin` library.
	- https://github.com/gofiber/contrib/blob/main/casbin/casbin_test.go

## Fitur yang Masih Kurang

### 1. Authentication & Authorization
- [x] **Refresh Token** - Implementasi refresh token untuk memperpanjang sesi pengguna tanpa harus login ulang
- [x] **Logout** - Endpoint untuk logout dan invalidasi token
- [x] **Forgot Password** - Fitur reset password via email (backend ready, perlu email service)
- [x] **Email Verification** - Verifikasi email setelah registrasi (backend ready, perlu email service)
- [x] **Change Password** - Endpoint untuk ubah password user yang sudah login
- [x] **Session Management** - Manage active sessions pengguna

### Dokumentasi
- [docs/API_AUTH.md](docs/API_AUTH.md) - Dokumentasi lengkap endpoint authentication

### 2. Testing
- [x] **Integration Tests** - Testing end-to-end untuk API endpoints
- [x] **Test Coverage Report** - Setup coverage report dengan minimal threshold (Current: 23.2%)
- [x] **Mock Database** - Setup mock untuk testing database operations
- [x] **API Testing Collection** - Postman collection untuk manual testing

### Dokumentasi
Lihat [docs/TESTING.md](docs/TESTING.md) untuk dokumentasi lengkap dari testing
Lihat [docs/TEST_COVERAGE.md](docs/TEST_COVERAGE.md) untuk dokumentasi lengkap test coverage report.

### 3. Documentation
- [x] **Postman Collection** - Export collection untuk API testing
- [x] **Architecture Documentation** - Dokumentasi arsitektur dan design pattern yang digunakan
- [x] **Deployment Guide** - Panduan deploy Docker Compose dengan production setup
- [x] **Contributing Guide** - Guidelines untuk kontributor dengan coding standards
- [x] **LICENSE File** - MIT License untuk open source project

### Dokumentasi
- [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md) - Clean Architecture pattern dan design patterns
- [docs/DEPLOYMENT.md](docs/DEPLOYMENT.md) - Deployment guide untuk Docker Compose
- [CONTRIBUTING.md](CONTRIBUTING.md) - Contributing guidelines dan coding standards

### 4. Logging & Monitoring
- [x] **Structured Logging** - Zap logger with Fiber integration via fiberzap middleware
- [x] **Request ID Tracking** - Trace request dengan unique ID (UUID)
- [x] **Access Logs** - Logging untuk semua incoming requests dengan detail lengkap
- [x] **Error Tracking** - Integration dengan Sentry untuk production error tracking
- [x] **Health Check Endpoint** - `/health`, `/health/ready`, `/health/live` untuk orchestration
- [x] **Lightweight Metrics** - Zero-dependency metrics di `/metrics` (tidak pakai Prometheus, super ringan!)
- [x] **Database Query Logging** - Logging slow queries dengan custom GORM logger

### Dokumentasi
Lihat [docs/LOGGING_MONITORING.md](docs/LOGGING_MONITORING.md) dan [docs/METRICS_MONITORING.md](docs/METRICS_MONITORING.md) untuk dokumentasi lengkap

### 5. Security
- [x] **API Rate Limiting per User** - Rate limit berdasarkan user ID/IP dengan in-memory store
- [x] **CSRF Protection** - Cross-Site Request Forgery protection dengan token validation
- [x] **Content Security Policy** - CSP headers configuration dengan custom policy support
- [x] **SQL Injection Prevention** - Prepared statements validation dan pattern detection
- [x] **XSS Protection** - Input sanitization dengan bluemonday
- [x] **HTTPS Redirect** - Auto redirect HTTP ke HTTPS di production
- [x] **Helmet Middleware** - Security headers (X-Frame-Options, HSTS, dll)
- [x] **API Key Authentication** - Alternative auth method untuk machine-to-machine access
- [x] **IP Whitelist/Blacklist** - Restrict access by IP dengan wildcard support
- [x] **Encryption at Rest** - Sensitive data encryption dengan AES-256-GCM

### Dokumentasi
Lihat [docs/SECURITY.md](docs/SECURITY.md) untuk dokumentasi lengkap fitur keamanan

### 6. Caching
- [x] **Redis Integration** - Caching layer dengan Redis client (go-redis v9)
- [x] **Cache Middleware** - Response caching untuk GET requests dengan configurable TTL
- [x] **Query Result Caching** - Helper functions untuk cache database query results
- [x] **Cache Invalidation Strategy** - Write-Through, TTL, pattern-based, dan cache stampede prevention

### Dokumentasi
Lihat [docs/CACHING.md](docs/CACHING.md) untuk dokumentasi lengkap caching system

### 7. Database
- [x] **Database Migration System** - Proper migration tool (golang-migrate) dengan helper functions
- [x] **Seeder** - Database seeder untuk development/testing dengan sample data
- [x] **Database Backup Scripts** - Automated backup mechanism dengan compression dan retention
- [x] **Connection Pooling Configuration** - Optimal connection pool settings (prod vs dev)
- [x] **Read Replica Support** - Load balancing untuk read operations dengan DBResolver
- [x] **Soft Delete Support** - Soft delete implementation dengan helper functions (WithTrashed, OnlyTrashed, Restore, ForceDelete)
- [x] **Audit Log** - Track semua perubahan data (who, when, what) dengan automatic GORM callbacks

### Dokumentasi
Lihat [docs/DATABASE.md](docs/DATABASE.md) untuk dokumentasi lengkap database management

### 8. File Management
- [x] **File Validation** - Validate file type, size, dan content dengan magic number checking
- [x] **Multiple File Upload** - Support upload multiple files sekaligus dengan concurrent processing
- [x] **Cloud Storage Integration** - AWS S3 integration dengan presigned URLs dan S3-compatible services
- [x] **Image Processing** - Resize, compress, thumbnail generation, rotate, flip, blur, sharpen, brightness/contrast adjustment
- [x] **File Versioning** - Keep track of file versions dengan checksum verification dan restore capabilities

### Dokumentasi
- Lihat [docs/FILE_MANAGEMENT.md](docs/FILE_MANAGEMENT.md) untuk dokumentasi lengkap file management system
- Lihat [Setup Minio](docs/MINIO_SETUP.md) untuk panduan setup MinIO sebagai local S3-compatible storage

### 9. API Features
- [x] **Response Compression** - Gzip compression untuk response dengan 3 compression levels
- [x] **Pagination Cursor-based** - Alternative untuk offset pagination, O(1) performance untuk large datasets
- [x] **Bulk Operations** - Bulk create/update/delete/restore/upsert dengan error tracking per record
- [x] **Export Data** - Export ke CSV/Excel/PDF dengan styling dan pagination otomatis
- [x] **Search & Filter** - Advanced search dengan 15+ operators (eq, gt, like, in, between, dll) dan AND/OR logic
- [x] **Sorting** - Multiple field sorting support dengan validation dan SQL injection protection

### Dokumentasi
Lihat [docs/API_FEATURES.md](docs/API_FEATURES.md) untuk dokumentasi lengkap API features dengan contoh penggunaan

### 10. Real-time Features
- [x] **Server-Sent Events (SSE)** - Real-time push notifications dari server ke client dengan event types, user targeting, broadcast, dan auto keep-alive

### Dokumentasi
Lihat [docs/SSE.md](docs/SSE.md) untuk dokumentasi lengkap SSE dengan contoh client implementation (JS, React, Vue)

### 11. Background Jobs
- [x] **Job Queue** - Asynq (Redis-based) untuk background task processing
- [x] **Scheduled Tasks** - Cron-like periodic tasks (mirip Laravel Scheduler)
- [x] **Email Queue** - Async email sending dengan priority queues
- [x] **Retry Mechanism** - Auto retry failed jobs dengan exponential backoff
- [x] **Job Dashboard** - Queue statistics, pause/resume, task management

### Dokumentasi
Lihat [docs/BACKGROUND_JOBS.md](docs/BACKGROUND_JOBS.md) untuk dokumentasi lengkap background jobs dan queue system

### 12. Email System
- [x] **Email Templates** - HTML + text email templates dengan responsive design
- [x] **Email Service Integration** - Multi-provider SMTP support (Mailpit, Mailgun, SendGrid, AWS SES, Gmail)
- [x] **Email Queue** - Async email processing via Asynq dengan auto-retry
- [x] **Email Verification** - Template untuk verify email dengan expiration
- [x] **Password Reset Email** - Template untuk reset password dengan security warnings
- [x] **Welcome Email** - Professional welcome email untuk new users
- [x] **Custom Email Support** - Send custom emails dengan HTML/text dan attachments
- [x] **Template System** - Go html/template engine dengan data binding

### Dokumentasi
Lihat [docs/EMAIL.md](docs/EMAIL.md) untuk dokumentasi lengkap email notification system dengan contoh konfigurasi SMTP providers dan template customization

### 13. DevOps & CI/CD
- [x] **Makefile** - Automation untuk common tasks (build, test, migrate)
- [x] **CI/CD Pipeline** - GitHub Actions untuk automated testing & deployment
- [x] **Docker Optimization** - Multi-stage build untuk smaller image size (~90% reduction)
- [x] **Pre-commit Hooks** - Automated checks sebelum commit (linting, formatting)

### Dokumentasi
Lihat [docs/DEVOPS.md](docs/DEVOPS.md) untuk dokumentasi lengkap DevOps & CI/CD setup

### 14. Performance
- [x] **Database Indexing** - Proper indexes untuk optimize queries dengan utilities dan recommended indexes
- [x] **Request Timeout** - Timeout configuration untuk all requests (ReadTimeout, WriteTimeout, IdleTimeout)
- [x] **Graceful Shutdown** - Proper shutdown handling dengan timeout protection untuk zero-downtime deployment

### Dokumentasi
Lihat [docs/PERFORMANCE.md](docs/PERFORMANCE.md) untuk dokumentasi lengkap performance optimization

### 15. User Management
- [x] **User Profile** - Get/Update user profile dengan avatar upload
- [x] **User Preferences** - Settings/preferences per user (notifications, privacy, UI settings)

### Dokumentasi
- [docs/API_AUTH.md](docs/API_AUTH.md) - Dokumentasi lengkap authentication endpoints

## üìö Dokumentasi Lengkap

> **üìñ Complete Index**: See [docs/README.md](docs/README.md) for organized documentation index by topic



### üèóÔ∏è Architecture & Setup
- **[docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)** - Clean Architecture pattern, design patterns, dan layer responsibilities
- **[docs/MIGRATION_GUIDE.md](docs/MIGRATION_GUIDE.md)** - Quick start guide untuk Atlas database migrations (Bahasa Indonesia)
- **[docs/DATABASE.md](docs/DATABASE.md)** - Database management lengkap: Atlas migrations, seeding, backup, optimization
- **[docs/MAKEFILE_COMMANDS.md](docs/MAKEFILE_COMMANDS.md)** - Reference lengkap untuk semua Makefile commands
- **[cmd/README.md](cmd/README.md)** - Convention untuk cmd/ folder dan cara run programs

### üîê Security & Authentication
- **[docs/API_AUTH.md](docs/API_AUTH.md)** - Authentication endpoints: register, login, profile, password reset
- **[docs/SECURITY.md](docs/SECURITY.md)** - Security features: rate limiting, CSRF, XSS, encryption, IP filtering
- **[docs/SECURITY_IMPLEMENTATION.md](docs/SECURITY_IMPLEMENTATION.md)** - Implementation details untuk security features

### üöÄ API Features & Optimization
- **[docs/API_FEATURES.md](docs/API_FEATURES.md)** - Advanced API features: pagination, bulk ops, export, search, filtering
- **[docs/API_FEATURES_QUICK_REF.md](docs/API_FEATURES_QUICK_REF.md)** - Quick reference untuk API features
- **[docs/PERFORMANCE.md](docs/PERFORMANCE.md)** - Performance optimization: indexing, timeout, graceful shutdown
- **[docs/CACHING.md](docs/CACHING.md)** - Redis caching system dengan strategies dan best practices

### üíæ Data & Storage
- **[docs/FILE_MANAGEMENT.md](docs/FILE_MANAGEMENT.md)** - File upload, validation, cloud storage (S3/MinIO), image processing
- **[docs/CLOUD_STORAGE_EXAMPLES.md](docs/CLOUD_STORAGE_EXAMPLES.md)** - Cloud storage implementation examples
- **[docs/MINIO_SETUP.md](docs/MINIO_SETUP.md)** - Setup MinIO sebagai local S3-compatible storage

### üîÑ Background Jobs & Real-time
- **[docs/BACKGROUND_JOBS.md](docs/BACKGROUND_JOBS.md)** - Background jobs dengan Asynq: queue, scheduler, email queue
- **[docs/BACKGROUND_JOBS_QUICK_REF.md](docs/BACKGROUND_JOBS_QUICK_REF.md)** - Quick reference untuk background jobs
- **[docs/SSE.md](docs/SSE.md)** - Server-Sent Events untuk real-time notifications
- **[docs/EMAIL.md](docs/EMAIL.md)** - Email system: templates, SMTP providers, async sending

### üìä Monitoring & Testing
- **[docs/LOGGING_MONITORING.md](docs/LOGGING_MONITORING.md)** - Structured logging dengan Zap dan Sentry integration
- **[docs/METRICS_MONITORING.md](docs/METRICS_MONITORING.md)** - Metrics endpoint dan health checks
- **[docs/TESTING.md](docs/TESTING.md)** - Testing guidelines dan best practices
- **[docs/TEST_COVERAGE.md](docs/TEST_COVERAGE.md)** - Test coverage reports dan analysis

### üö¢ Deployment & DevOps
- **[docs/DEPLOYMENT.md](docs/DEPLOYMENT.md)** - Deployment guide untuk Docker Compose
- **[docs/DEVOPS.md](docs/DEVOPS.md)** - DevOps setup: CI/CD, Makefile, pre-commit hooks, Docker optimization

### üìñ Additional Resources
- **[CONTRIBUTING.md](CONTRIBUTING.md)** - Contributing guidelines dan coding standards
- **[LICENSE](LICENSE)** - MIT License
- **[.cursorrules](.cursorrules)** - AI assistant rules dan project conventions

---

## Prioritas Implementasi (Rekomendasi)

### High Priority
1. **API Documentation (Swagger)** - Auto-generated API docs
2. **Graceful Shutdown** - Zero-downtime deployment support
3. **Database Indexing** - Query performance optimization

### Medium Priority
1. **CI/CD Pipeline** - Automated testing & deployment
2. **Makefile** - Development automation
3. **User Profile Management** - Basic user profile features

### Low Priority
1. **API Versioning** - Backward compatibility management
2. **Request Timeout** - Request timeout configuration